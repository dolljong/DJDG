<html>
<head>
 <style>
 p {font-size:10pt;}
 td {font-size:10pt;}
 li {font-size:10pt;}
 </style>  
 <title>CAD의 Pline좌표를 Excel로 data로...</title>
</head>
<body>

<table  ><tr><td>
<img src=pline2xls1.gif>
<td bgcolor=navy><font size=3 color=white><b>&nbsp; CAD의 Pline좌표를 Excel로 data로... &nbsp;</b>
</table>

<p>
CAD에 있는 pline의 좌표를 Excel로 불러들여야 하는 경우가 있습니다. 예를 들어서 다른 사람이 작업한 종단파일을 받았는데
지반고를 주워서 Excel파일로 만들어야 되는 경우라든가, 형고가 변하는 거더교의 중심선을 따라서 모델링을 했는데 그 좌표값들을
구해야 한다든가 하는 작업이 있을 수있을 것입니다. 지금까지 이런 작업은 [다정다감]의 <a href=../../8/coord2.htm>coord2</a>나 
<a href=../../8/numcoor.htm>numcoor</a>를 사용했을 것입니다. 하지만 번거로운 edit잡업을 해야하는 경우가 많았습니다. Pline2xls는 
CAD의 Pline을 선택하면 그 좌표들을 Excel의 셀에 넣어줍니다.
</p>

<b>기능</b><br>
<ul>
<li> CAD의 Pline좌표를 Excel의 셀에 넣기
<li> x,y scale을 다르게 그리기 가능
</ul>


<b>사용법</b><br>



<p>
Excel에서 [다정다감] toolbar의 pline2xls버튼 클릭합니다. 만일 [다정다감] toolbar가 보이지 않는다면 이 도움말의 
<a href=../install/djdgxlainst.htm>djdg.xla설치하기</a> 를 참조하시기 바랍니다.</P>



<p>
pline2xls 버튼을 클릭하면 낯익은  다이얼로그 박스가 하나 뜹니다. 어디서 많이 본듯한 다이얼로그 박스라고 생각되지
않으십니까? 캐드의 insert명령 다이얼로그 박스와 유사합니다. </p>

<img src=pline2xls2.gif> <br>

<p>
사용자의 취향에 알맞게 옵션을 선택한 후에 ok버튼을 누르면 아래와 같이 캐드로 옮겨져서 Pline을 선택하라는 메시지가 나옵니다. Pline을 선택합니다.</p>

<img src=pline2xls3.gif><br>
    
<p>Pline을 선택하면 다시 Excel로 넘어와서 아래 그림과 같이 좌표값을 저장할 Cell을 선택하라는 메시지가 나옵니다. 마우스로 원하는 Cell을 선택하고
확인 버튼을 누르면 오른쪽 그림과 같이 Cell들에 node번호, X좌표, Y좌표가 들어가게 됩니다.</P>    

<img src=pline2xls4.gif> <img src=pline2xls5.gif><br>
    
<br>
<b>옵션</b><br>
<p>
그럼 옵션에 대해서 간단하게 설명드리겠습니다. 캐드를 사용해보신 분들은 대충은 이해하시리라 생각됩니다. 다이얼로그박스는 크게 세부분으로
나누어 생각할 수 있습니다. insert point와 scale이 그것입니다.</p>


<table>

<tr><td valign=top><img src=pline2xls6.gif><td> Insert point를 직접 CAD의 화면에석 찍을 때 사용됩니다. 
<tr><td valign=top><img src=pline2xls7.gif><td>x,y Scale이 일정할 때 사용합니다. 이 체크박스를 선택하면 x스케일이 y스케일에 똑같이 적용됩니다.
</table>


<br>
<b>사용예</b><br>    


<p><b>모델링의 절점좌표 만들기</b><br>아래 그림과 같이 π형 교각의 코핑부를 중심선을 따라 모델링하는 경우 생각보다 여러개의 
절점을 잘라야 됩니다. 일단  편구배로 인한 단차 때문에 대부분의 위치에서 코핑의 높이가 다르고, 교좌장치위치, 단차위치, 기둥의 단부, 
기둥의 지름의 1/10위치 등 여러부분을 잘라야 합니다. 이런 경우에 코핑하단의 형상이 원인경우에는 더욱더 좌표구하기가 짱나는 작업일
수 있습니다. 어차피 일반도 없는 해석은 없습니다. 따라서 작성된 도면을 최대한 이용해서 모델링 및 구조계산을 하는 것이 시간절약하는
데 도움이 될 것입니다. 
</p>

<img src=pline2xls8.gif><br>

<p>노란 선이 코핑의 줌심선을 연결한 pline입니다. 도면은 mm단위로 그려져있지만 모델링을 mm단위로 하는 사람은 없겠죠? 
따라서 pline2xls에서 scale을 0.001로 주도록 합니다. 또한 사용자가 원하는 점이 원점이 되도록 on screen option을 사용해서 
코핑중심점을 찍어 0,0이 되도록 좌표를 읽어보도록 하겠습니다. </p>

<p>DJDG툴바에서 Pline2Xls를 선택하고 아래와 같이 onscreen을 체크하고 x-scale에 0.001을 입력하고 Uniform을 체크하면
X,Y스케일이 같아집니다. 그런다음 확인을 누르면 CAD로 옮겨져서 Pline을 선택합니다. Onscreen을 체크했기 때문에 Pick Insert메세지가
나오면서 사용자가 Insert point를 찍을 때까지 기다립니다. 코핑의 중앙을 찍어주면 Excel로 넘어가서 좌표를 뿌려줄 cell을 선택하는
창이 나옵니다. 정당한 셀을 선택하고 확인을 누르면 xy좌표가 Excel에 뿌려집니다. </p>

<p>총 15개의 node이고, 기준점으로 선택한 8번째 node의 좌표가 0.000,0.000으로 되어있는 것을 보실 수 있을 것입니다. </p>

<img src=pline2xls9.gif> <img src=pline2xls10.gif align=top>


</body>
</html>